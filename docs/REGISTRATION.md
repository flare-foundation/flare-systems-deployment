# Entity Registration

## Entity Manager

The `EntityManager` contract will be required throughout this guide. It can be
found here:

- for
  [Coston](https://coston-explorer.flare.network/address/0x60A848E5Da796D741e559c170E851FC813061217?tab=write_contract)
- for
  [Songbird](https://songbird-explorer.flare.network/address/0x46C417D0760198E94fee455CE0e223262a3D0049/write-contract#address-tabs)
- for
  [Coston2](https://coston2-explorer.flare.network/address/0xE62c5557210a5D095BfC2fDc8B2b5D64609cfDf1?tab=write_contract)
- for
  [Flare](https://flare-explorer.flare.network/address/0x134b3311C6BdeD895556807a30C7f047D99DfdC2)

## Entity registration

You will need 5 addresses to be able to participate in the protocol:

- **Identity address**: entity's main address
  - should be stored in a cold storage as it will only ever be needed in the
    initial setup and any future rotation of other keys
- **Submit address**: used for submit1, submit2 and submit3 transactions
  - can be stored in a hot storage as its private key will be added to `.env`
    file during deployment
- **Submit signatures**: used for submitSignatures transactions
  - can be stored in a hot storage as its private key will be added to `.env`
    file during deployment
- **Signing policy**: used for reward epoch registration and relay transactions
  as well as payload signing in some parts of the system
  - can be stored in a hot storage as its private key will be added to `.env`
    file during deployment
- **Delegation address**: used for wrapping your tokens and getting delegation
  - should be stored in a cold storage as it will not be needed in day to day
    protocol participation

All 5 addresses will need to be funded for gas fees.

You can register above keys via `EntityManager` contract by first calling
`propose...Address` with your identity address and then calling
`confirm...Address` with proposed address.

If you have a safe environment to work with you can register your entity with a
script by following [REGISTER_TASK.md](REGISTER_TASK.md).

## Fast Updates

### Addresses

Additional 3 addresses will need to be generated for fast updates system. These
addresses don't require any registration and can be stored in hot storage as
their private keys will be added to `.env` file during deployment.

### Sortition key

You will need to generate a sortition private/public key pair for use in the
fast updates system. This key can be in hot storage as it will be added to
`.env` file during deployment. The key can be generated by running the `keygen`
cli that can be found
[here](https://github.com/flare-foundation/fast-updates/blob/main/go-client/keygen/keygen.go).
You can also run with with docker:

```bash
docker run --rm ghcr.io/flare-foundation/fast-updates/go-client keygen
```

You can register above generated key via `EntityManager` contract by calling
`registerPublicKey` with your identity address.

If you have a safe environment to work with you can register your entity with a
script by following [REGISTER_TASK.md](REGISTER_TASK.md).

## Validator nodes

Your validator nodes need to be registered with the Entity system. You can do
this via `EntityManager` contract by calling `registerNodeId` with your identity
address for each of your validator nodes. The three required values can be
generated as described in [VALIDATOR_NODE.md](VALIDATOR_NODE.md).
